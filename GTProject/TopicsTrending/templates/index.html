<!DOCTYPE html>
<html>
<head>
    <title>Index</title>
</head>
<body>
    <h1>TopicsTrending</h1>
    
    <form id="job_form" action="{% url 'skill_list' %}" method="get">
        <label for="job_select">Select a job:</label>
        <select id="job_select" name="job">
            <option value="">Select a job</option>
            {% for job in jobs %}
                <option value="{{ job.name }}">{{ job.name }}</option>
            {% endfor %}
        </select>
    </form>

    <h2>Skills for selected job:</h2>
    <ul id="skills_list">
        <!-- 기술과 개수를 함께 표시 -->
    </ul>







    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        // 페이지가 로드되면 실행될 함수입니다.
        $(document).ready(function() {
            // 선택된 직업에 대한 기술 목록을 가져올 URL입니다.
            var skillListUrl = '/skill';

            // 직업 선택이 변경되었을 때 실행될 함수입니다.
            $('#job_select').change(function() {
                // 선택된 직업의 ID를 가져옵니다.
                var jobId = $(this).val();

                // 기존의 기술 목록을 지웁니다.
                $('#skills_list').empty();

                // 선택된 직업이 존재할 경우에만 기술을 가져옵니다.
                if (jobId) {
                    // AJAX 요청을 통해 서버에 선택된 직업에 해당하는 기술 목록을 요청합니다.
                    $.ajax({
                        url: skillListUrl,  // 서버에 요청할 URL입니다.
                        type: 'GET',        // HTTP 요청 방식은 GET입니다.
                        data: { job: jobId },  // 요청에 추가할 데이터입니다 (선택된 직업의 ID).
                        success: function(data) {
                            // 서버로부터 받은 기술 목록을 순회하며 각 기술을 페이지에 추가합니다.
                            $.each(data, function(index, skill) {
                                // 기술과 그에 해당하는 개수를 함께 페이지에 추가합니다.
                                $('#skills_list').append($('<li>').text(skill.name + ' : ' + skill.count));
                            });
                        }
                    });
                }
            });
        });
    </script>
</body>
</html>
